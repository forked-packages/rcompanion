<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pseudo r-squared measures for various models — nagelkerke • rcompanion</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pseudo r-squared measures for various models — nagelkerke" />
<meta property="og:description" content="Produces McFadden, Cox and Snell, and Nagelkerke pseudo 
             R-squared measures, along with p-values, for models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rcompanion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pseudo r-squared measures for various models</h1>
    
    <div class="hidden name"><code>nagelkerke.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces McFadden, Cox and Snell, and Nagelkerke pseudo 
             R-squared measures, along with p-values, for models.</p>
    </div>

    <pre class="usage"><span class='fu'>nagelkerke</span>(<span class='no'>fit</span>, <span class='kw'>null</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>restrictNobs</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>The fitted model object for which to determine pseudo r-squared.</p></td>
    </tr>
    <tr>
      <th>null</th>
      <td><p>The null model object against which to compare the fitted model 
object. The null model must be nested in the fitted model to be 
valid. Specifying the null
is optional for some model object types
and is required for others.</p></td>
    </tr>
    <tr>
      <th>restrictNobs</th>
      <td><p>If <code>TRUE</code>, limits the observations for the null
model to those used in the fitted model.
Works with only some model object types.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of six objects describing the models used, the pseudo 
        r-squared values, the likelihood ratio test for the model,
        the number of obervaton for the models,
        messages, and any warnings.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Pseudo R-squared values are not directly comparable to the  
          R-squared for OLS models.  Nor can they be interpreted as the  
          proportion of the variability in the dependent variable that is  
          explained by model. Instead pseudo R-squared measures are relative
          measures among similar models indicating how well the model
          explains the data.</p>          
<p>Cox and Snell is also referred to as ML. Nagelkerke is also  
          referred to as Cragg and Uhler.</p>          
<p>Model objects accepted are lm, glm, gls, lme, lmer, lmerTest, nls,
          clm, clmm, vglm, glmer, negbin, zeroinfl, betareg, and rq.</p>                                      
<p>Model objects that require the null model to 
          be defined are nls, lmer, glmer, and clmm. 
          Other objects use the <code>update</code> function to
          define the null model.</p>          
<p>Likelihoods are found using ML (<code>REML = FALSE</code>).</p>          
<p>The fitted model and the null model
          should be properly nested.
          That is, the terms of one need to be a subset of the the other,
          and they should have the same set of observations.
          One issue arises when there are <code>NA</code>
          values in one variable but not another, and observations with 
          <code>NA</code> are removed in the model fitting.  The result may be
          fitted and null models with
          different sets of observations.
          Setting <code>restrictNobs</code> to <code>TRUE</code> 
          ensures that only observations in
          the fit model are used in the null model.
          This appears to work for <code>lm</code> and some <code>glm</code> models,
          but causes the function to fail for other model
          object types.</p>          
<p>Some pseudo R-squared measures may not be appropriate
          or useful for some model types.</p>          
<p>Calculations are based on log likelihood values for models.
          Results may be different than those based on deviance.</p>
    <h2 class="hasAnchor" id="acknowledgements"><a class="anchor" href="#acknowledgements"></a>Acknowledgements</h2>

    

<p>My thanks to
         Jan-Herman Kuiper of Keele University for suggesting
         the <code>restrictNobs</code> fix.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='http://rcompanion.org/handbook/G_10.html'>http://rcompanion.org/handbook/G_10.html</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='accuracy.html'>accuracy</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### Logistic regression example</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>AndersonBias</span>)
<span class='no'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>Result</span> ~ <span class='no'>County</span> + <span class='no'>Sex</span> + <span class='no'>County</span>:<span class='no'>Sex</span>,
           <span class='kw'>weight</span> <span class='kw'>=</span> <span class='no'>Count</span>,
           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>AndersonBias</span>,
           <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span>(<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"logit"</span>))
<span class='fu'>nagelkerke</span>(<span class='no'>model</span>)</div><div class='output co'>#&gt; $Models
#&gt;                                                                                                  
#&gt; Model: "glm, Result ~ County + Sex + County:Sex, binomial(link = \"logit\"), AndersonBias, Count"
#&gt; Null:  "glm, Result ~ 1, binomial(link = \"logit\"), AndersonBias, Count"                        
#&gt; 
#&gt; $Pseudo.R.squared.for.model.vs.null
#&gt;                              Pseudo.R.squared
#&gt; McFadden                            0.0797857
#&gt; Cox and Snell (ML)                  0.7136520
#&gt; Nagelkerke (Cragg and Uhler)        0.7136520
#&gt; 
#&gt; $Likelihood.ratio.test
#&gt;  Df.diff LogLik.diff  Chisq   p.value
#&gt;       -7     -10.004 20.009 0.0055508
#&gt; 
#&gt; $Number.of.observations
#&gt;          
#&gt; Model: 16
#&gt; Null:  16
#&gt; 
#&gt; $Messages
#&gt; [1] "Note: For models fit with REML, these statistics are based on refitting with ML"
#&gt; 
#&gt; $Warnings
#&gt; [1] "None"
#&gt; </div><div class='input'>
<span class='co'>### Quadratic plateau example </span>
<span class='co'>### With nls, the  null needs to be defined</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BrendonSmall</span>)
<span class='no'>quadplat</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>a</span>, <span class='no'>b</span>, <span class='no'>clx</span>) {
          <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x</span>  <span class='kw'>&lt;</span> <span class='no'>clx</span>, <span class='no'>a</span> + <span class='no'>b</span> * <span class='no'>x</span>   + (-<span class='fl'>0.5</span>*<span class='no'>b</span>/<span class='no'>clx</span>) * <span class='no'>x</span>   * <span class='no'>x</span>,
                           <span class='no'>a</span> + <span class='no'>b</span> * <span class='no'>clx</span> + (-<span class='fl'>0.5</span>*<span class='no'>b</span>/<span class='no'>clx</span>) * <span class='no'>clx</span> * <span class='no'>clx</span>)}
<span class='no'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>Sodium</span> ~ <span class='fu'>quadplat</span>(<span class='no'>Calories</span>, <span class='no'>a</span>, <span class='no'>b</span>, <span class='no'>clx</span>),
            <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BrendonSmall</span>,
            <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>a</span>   <span class='kw'>=</span> <span class='fl'>519</span>,
                         <span class='kw'>b</span>   <span class='kw'>=</span> <span class='fl'>0.359</span>,
                         <span class='kw'>clx</span> <span class='kw'>=</span> <span class='fl'>2304</span>))
<span class='no'>nullfunct</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>m</span>){<span class='no'>m</span>}
<span class='no'>null.model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>Sodium</span> ~ <span class='fu'>nullfunct</span>(<span class='no'>Calories</span>, <span class='no'>m</span>),
             <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BrendonSmall</span>,
             <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>m</span>   <span class='kw'>=</span> <span class='fl'>1346</span>))
<span class='fu'>nagelkerke</span>(<span class='no'>model</span>, <span class='kw'>null</span><span class='kw'>=</span><span class='no'>null.model</span>)</div><div class='output co'>#&gt; $Models
#&gt;                                                                                                                                                                      
#&gt; Model: "nls, Sodium ~ quadplat(Calories, a, b, clx), BrendonSmall, list(a = 519, b = 0.359, clx = 2304), default, list(50, 1e-05, 0.0009765625, FALSE, FALSE), FALSE"
#&gt; Null:  "nls, Sodium ~ nullfunct(Calories, m), BrendonSmall, list(m = 1346), default, list(50, 1e-05, 0.0009765625, FALSE, FALSE), FALSE"                             
#&gt; 
#&gt; $Pseudo.R.squared.for.model.vs.null
#&gt;                              Pseudo.R.squared
#&gt; McFadden                             0.175609
#&gt; Cox and Snell (ML)                   0.864674
#&gt; Nagelkerke (Cragg and Uhler)         0.864683
#&gt; 
#&gt; $Likelihood.ratio.test
#&gt;  Df.diff LogLik.diff  Chisq    p.value
#&gt;       -2     -45.001 90.003 2.8583e-20
#&gt; 
#&gt; $Number.of.observations
#&gt;          
#&gt; Model: 45
#&gt; Null:  45
#&gt; 
#&gt; $Messages
#&gt; [1] "Note: For models fit with REML, these statistics are based on refitting with ML"
#&gt; 
#&gt; $Warnings
#&gt; [1] "None"
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Salvatore Mangiafico.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


